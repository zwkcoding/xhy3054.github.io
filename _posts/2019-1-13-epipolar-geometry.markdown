---
layout: post
title: 理解对极几何与基本矩阵 
date: 2019-01-13 10:07:24.000000000 +09:00
img:  game2.png # Add image post (optional)
tag: [图像处理]
---
对极几何是**两幅视图**之间内在的射影几何。它独立于景物结构，只依赖于摄像机的内参外参。

而基本矩阵是对对极几何的代数表示。

# 对极几何
如下图所示，对极几何通常用来解决双眼匹配搜索对应点的问题。
<div style="text-align: center">
<img src="{{site.baseurl}}/assets/img/epipolar_geometry/epipolar1.png"  width="750" height="320"/>
</div>
上图a中两个摄像机的中心分别是C与C'，而X为一个三维空间点，它在两个摄像机的成像平面上的投影点分别是x与x'。我们常称：
- **基线**：两个摄像机光心的连线$CC'$
- **对极点**：上图b中的e与e'，它们分别是一幅视图中另一个摄像机中心的像。二维表示为基线$CC'$与两个成像平面的交点。
- **对极平面**：是一张包含基线的平面，存在着对极平面的一个集合（以基线为轴转动），上图中的一个例子就是$CXC'$。
- **对极线**：对极平面与图像平面的交线。上图中的例子是$xe$与$x'e'$，一个成像平面上的所有的对极线相交于对极点。

> 上图中还体现了一些性质，对于一幅图像上的每一点x，在第二幅图像上，任何与该点x匹配的点x'必然在对极线I'上，该对极线是过点x与第一个摄像机中心C的射线在第二幅图像上的投影。

## 基本矩阵F
由上面的讲述，我们知道，对于一幅图像上的一点x，映射在另一幅图像上是一条与之对应的对极线I'。

$$ x \rightarrowtail I' $$

剧本矩阵F表示的正是这个从点到直线的射影映射。

### 几何推导
如下图所示，我们假设具有如下图所示的対极约束关系。
<div style="text-align: center">
<img src="{{site.baseurl}}/assets/img/epipolar_geometry/jihe.png"/>
</div>
- 其中不通过任何两个摄像机中心的平面$\pi$上的一点X经过投影后在两个摄像机成像平面上的投影点分别是x与x'。
- 存在一个2D单应$H_{\pi}$把每一个$x_i$（$\pi$平面上的点在第一个相机平面上的投影点）映射到$x_i'$$\pi$平面上的点在第二个相机平面上的投影点）
- 给定点x'，通过x'和对极点e'的对极线I'可以记为$I' = e' \times x' = [e']_{\times} x'$(后面那种写法是一种叉乘的一种形式)，又因为$x' = H_{\pi} x$，所以最终得到下式：

$$ I' = [e']_{\times} H_{\pi} x = Fx $$

其中定义了基本矩阵$ F = [e']_{\times}H_{\pi} $

> 由上，我们发现基本矩阵F实现的是从二维（二维点）到一维（一条线上的点）的转换，因此F的秩只能是2。

### 代数推导
- 首先对于两个视图的射影矩阵P、P'，第一个视图中通过x和光心O的射线可以由方程$PX=x$解出：

$$ X(\lambda) = P^{+}x + \lambda O $$

其中，$P^{+}$是P的伪逆，即$P^{+}P = I$，O为相机的中心，即P的零矢量并且定义为$PO = 0$

- 额没看懂，以后补，最后得出基本矩阵F

$$ F = [e']_{\times} (P' P_{+}) $$

- 将世界坐标系定在第一个视图，最终得到：

$$ F = [e']_{\times} (P' P_{+}) = K^{'-T}RK^T[e]_{\times} $$

### 性质
基本矩阵是一个秩为2的$3\times3$齐次线性矩阵

- 对应点：　$$ x'Fx = 0 $$
- 对应线：　　
    - $I' = Fx$对应于x的对极线
    - $I = F^T x$对应于x'的对极线
- 对极点：
    - $Fe = 0$
    - $F^Te = 0$

# 参考资料
- [1] 《Multiple View Geometry in Computer Vision (Second Edition)》

